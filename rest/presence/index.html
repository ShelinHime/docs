<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Ably API Documentation - Presence</title>
    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="stylesheet" type="text/css" href="/vendor/prettify/prettify.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/stylesheet.css" media="screen">

    <script src="/vendor/javascripts/jquery-1-8-3-min.js" type="text/javascript"></script>
    <script src="/vendor/javascripts/jquery-cookie-1-3-1.js" type="text/javascript"></script>
    <script src="/vendor/javascripts/base64.js" type="text/javascript"></script>

    <script src="/vendor/prettify/prettify-lib.js" type="text/javascript"></script>

    <script src="//cdn.ably.io/lib/ably.min.js" type="text/javascript"></script>

    <script src="/javascripts/application.js" type="text/javascript"></script>
    <script src="/javascripts/lang-manager.js" type="text/javascript"></script>

    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="nanoc 3.7.5">
  </head>
  <body>
    <div class="canonical-notice">
      <img src="/images/icon-alert.png">
      <span class="canonical-notice-text">
        You are viewing our bleeding edge unstable documentation. We recommend you use our <a href="https://www.ably.io/documentation">stable documentation Â»</a>
      </span>
      <img src="/images/icon-alert.png">
    </div>
    <div class="fork-banner"><a href="https://github.com/ably/docs"><img src="/images/forkme.png" alt="Fork me on GitHub"></a></div>

  <div id="documentation">
    
      <nav class="jump-to-nav">
        <div class="form">
          <select id="jump-to-nav">
            <option>Jump to ...</option>
            <optgroup label='Help with'>
<option id="anchor-presence">Presence</option>
<option id="anchor-member-data">Member data</option>
<option id="anchor-member-list">Presence member list</option>
<option id="anchor-presence-history">Presence history</option>
</optgroup>
<optgroup label='Presence API reference'>
<option id="anchor-get">get</option>
<option id="anchor-history">history</option>
</optgroup>
          </select>
        </div>
      </nav>
    
    <header>
      
        <div class="breadcrumb"><a href="/rest/">REST Client Library API</a><span class="separator">/</span></div>
      
      
        <h1 id="title">Presence</h1>
      
    </header>
    <article>
      <p>Presence enables clients to be aware of other clients that are currently &#8220;present&#8221; on a channel. Each member present on a channel has a unique self-assigned client identifier and system-assigned connection identifier, along with an optional payload that can be used to describe the member&#8217;s status or attributes. Presence allows you to quickly build apps such as chat rooms and multiplayer games by automatically keeping track of who is present in real time across any device.</p>
<h2 id="presence">Presence</h2>
<p>Using the <a href="/rest-api">Ably REST API</a> it is possible to obtain the set of members currently present on a channel, or obtain the presence history for the channel, if persistence is enabled for that channel.</p>
<p>Since the <a href="/rest-api">Ably REST API</a> is stateless, and REST clients do not have realtime connections to the Ably service, it is not possible to enter or leave a channel via the REST API. Find out more about <a href="/realtime/presence">using presence with the Realtime API</a>.</p>
<p>A single <span lang="default"><a href="/rest/usage#client-id"><code>clientId</code></a></span><span lang="ruby"><a href="/rest/usage#client-id"><code>client_id</code></a></span> may be present multiple times on the same channel via different client connections. As far as Ably is concerned, these are different members of the presence set for the channel, however they will be differentiated by their unique <span lang="default"><a href="/realtime/connection#id"><code>connectionId</code></a></span><span lang="ruby"><a href="/realtime/connection/#id"><code>connection_id</code></a></span>. For example, if a client with ID &#8220;Sarah&#8221; is connected to a chat channel on both a desktop and a mobile device simultaneously, &#8220;Sarah&#8221; will be present twice in the presence member set with the same client ID, yet will have two unique connection IDs. A member of the presence set is therefore unique by the combination of the <span lang="default"><a href="/rest/usage#client-id"><code>clientId</code></a></span><span lang="ruby"><a href="/rest/usage#client-id"><code>client_id</code></a></span> and <span lang="default"><a href="/realtime/connection#id"><code>connectionId</code></a></span><span lang="ruby"><a href="/realtime/connection/#id"><code>connection_id</code></a></span> strings.</p>
<h3 id="presence-states">Presence states and events</h3>
<p>Whenever a member enters or leaves a channel, or updates <a href="#member-data">their member data</a>, a presence event is emitted to all presence subscribers on that channel. Subscribing to presence events makes it incredibly easy to build an app that shows, in real time, any changes to clients connected to Ably and present on a channel.</p>
<p>The following presence events are emitted:</p>
<dl>
	<dt><span lang="ruby"><code>:enter</code></span><span lang="java"><code>Action.ENTER</code></span><span lang="default"><code>enter</code></span></dt>
	<dd>A new member has entered the channel</dd>
</dl>
<dl>
	<dt><span lang="ruby"><code>:leave</code></span><span lang="java"><code>Action.LEAVE</code></span><span lang="default"><code>leave</code></span></dt>
	<dd>A member who was present has now left the channel. This may be a result of an explicit request to leave or implicitly when detaching from the channel. Alternatively, if a member&#8217;s connection is abruptly disconnected and they do not resume their connection within a minute, Ably treats this as a leave event as the client is no longer present</dd>
</dl>
<dl>
	<dt><span lang="ruby"><code>:update</code></span><span lang="java"><code>Action.UPDATE</code></span><span lang="default"><code>update</code></span></dt>
	<dd>An already present member has updated their <a href="#member-data">member data</a>. Being notified of member data updates can be very useful, for example, it can be used to update the status of a user when they are typing a message</dd>
</dl>
<dl>
	<dt><span lang="ruby"><code>:present</code></span><span lang="java"><code>Action.PRESENT</code></span><span lang="default"><code>present</code></span></dt>
	<dd>When subscribing to presence events on a channel that already has members present, this event is emitted for every member already present on the channel before the subscribe listener was registered</dd>
</dl>
<p><a href="https://jsbin.ably.io:443/ovavik/1/edit?javascript,live">View a realtime presence states and events example</a></p>
<h3 id="member-data">Member data</h3>
<p>In addition to the <span lang="default"><a href="/rest/usage#client-id"><code>clientId</code></a></span><span lang="ruby"><a href="/rest/usage#client-id"><code>client_id</code></a></span> for members on a channel, it is also possible to include data when entering a channel. Clients can <a href="#update">update</a> their data at any point which will be broadcasted to all presence subscribers as an <span lang="ruby"><code>:update</code></span><span lang="java"><code>Action.UPDATE</code></span><span lang="default"><code>update</code></span> event.</p>
<p>See the <a href="/realtime/presence#member-data">Realtime Presence Member data documentation</a> for more info.</p>
<h3 id="member-list">Presence member list</h3>
<p>The <code>Presence</code> object exposes a <a href="#get"><code>get</code></a> method allowing a client to retrieve an array of all members currently present on the channel. In the REST client library this method directly queries <a href="/rest-api#presence">Ably&#8217;s REST presence API</a>. No presence state is cached in the library itself, unlike in the <a href="/realtime">Realtime client library</a>.</p>
<pre lang="javascript"><code lang="javascript">channel.presence.get(function(err, membersPage) {
  console.log(membersPage.items.length + ' presence members in first page');
  if(membersPage.hasNext()) {
    membersPage.next(function(err, nextPage) { ... });
  }
});</code></pre>
<pre lang="nodejs"><code lang="nodejs">channel.presence.get(function(err, membersPage) {
  console.log(membersPage.items.length + ' presence members in first page');
  if(membersPage.hasNext()) {
    membersPage.next(function(err, nextPage) { ... });
  }
});</code></pre>
<pre lang="ruby"><code lang="ruby">members_page = channel.presence.get
puts "#{result_page.items.length} presence members in first page"
if result_page.has_next?
  next_page = result_page.next
end</code></pre>
<pre lang="java"><code lang="java">PaginatedResult&lt;PresenceMessage&gt; membersPage = channel.presence.get(null);
System.out.println(membersPage.items().length + " members in first page");
if(membersPage.hasNext()) {
  PaginatedResult&lt;PresenceMessage&gt; nextPage = membersPage.next();
  System.out.println(nextPage.items().length + " members on 2nd page");
}</code></pre>
<pre lang="objc"><code lang="objc">[channel.presence get:^(ARTPaginatedResult&lt;ARTPresenceMessage *&gt; *membersPage, NSError *error) {
    NSLog(@"%lu members in first page", [membersPage.items count]);
    if (membersPage.hasNext) {
        [membersPage next:^(ARTPaginatedResult&lt;ARTPresenceMessage *&gt; *nextPage, NSError *error) {
            NSLog(@"%lu members on 2nd page", [nextPage.items count]);
        }];
    }
}];</code></pre>
<pre lang="swift"><code lang="swift">channel.presence.get { membersPage, error in
    let membersPage = membersPage!
    print("\(membersPage.items.count) in first page")
    if membersPage.hasNext {
        membersPage.next { nextPage, error in
            print("\(nextPage!.items.count) members on 2nd page")
        }
    }
}</code></pre>
<h3 id="presence-history">Presence History</h3>
<p>The <code>Presence</code> object exposes a <a href="#history"><code>history</code></a> method allowing a client to retrieve historical presence events on the channel.</p>
<p>History provides access to instantaneous &#8220;live&#8221; history as well as the longer term persisted history for presence channels. If <a href="/realtime/history#persisted-history">persisted history</a> is enabled for the channel, then presence events will <a href="https://support.ably.io/solution/articles/3000030059-how-long-are-messages-stored-for">typically be stored for 24 &#8211; 72 hours</a>. If persisted history is not enabled, Ably retains the last two minutes of presence event history in memory.</p>
<p>The following example retrieves the first two pages of historical presence events published.</p>
<pre lang="javascript"><code lang="javascript">var presence = channel.presence;
presence.history(function(err, resultPage) {
  if(err) {
    console.log('Unable to get presence history; err = ' + err.message);
  } else {
    console.log(resultPage.items.length + ' presence events received in first page');
    if(resultPage.hasNext()) {
      resultPage.next(function(err, nextPage) { ... });
    }
});</code></pre>
<pre lang="nodejs"><code lang="nodejs">var presence = channel.presence;
presence.history(function(err, resultPage) {
  if(err) {
    console.log('Unable to get presence history; err = ' + err.message);
  } else {
    console.log(resultPage.items.length + ' presence events received in first page');
    if(resultPage.hasNext()) {
      resultPage.next(function(err, nextPage) { ... });
    }
});</code></pre>
<pre lang="ruby"><code lang="ruby">presence = channel.presence
presence.history do |result_page|
  puts "#{result_page.items.length} presence events received in first page"
  if result_page.has_next?
    result_page.next { |next_page| ... }
  end
end</code></pre>
<pre lang="java"><code lang="java">PaginatedResult&lt;PresenceMessage&gt; resultPage = channel.presence.history(null);
System.out.println(resultPage.items().length + " presence events received in first page");
if(resultPage.hasNext()) {
  PaginatedResult&lt;PresenceMessage&gt; nextPage = resultPage.next();
  System.out.println(nextPage.items().length + " presence events received in 2nd page");
}</code></pre>
<pre lang="objc"><code lang="objc">[channel.presence history:^(ARTPaginatedResult&lt;ARTPresenceMessage *&gt; *resultPage, NSError *error) {
    NSLog(@"%lu presence events received in first page", [resultPage.items count]);
    if (resultPage.hasNext) {
        [resultPage next:^(ARTPaginatedResult&lt;ARTPresenceMessage *&gt; *nextPage, NSError *error) {
            NSLog(@"%lu presence events received in 2nd page", [nextPage.items count]);
        }];
    }
}];</code></pre>
<pre lang="swift"><code lang="swift">channel.presence.history { resultPage, error in
    let resultPage = resultPage!
    print("\(resultPage.items.count) presence events received in first page")
    if resultPage.hasNext {
        resultPage.next { nextPage, error in
            print("\(nextPage!.items.count) presence events received in 2nd page")
        }
    }
}</code></pre>
<p>See the <a href="/rest/history#presence-history">presence history documentation</a> for further details of the supported query parameters.</p>
<h1>API Reference</h1>
<div class="inline-toc">
<ul><li>Presence reference
<ul>
<li>
Methods
<ul>
<li><a href='#get'>get(options)</a></li>
<li><a href='#get'>history(options)</a></li>
</ul>
</li>
<li>
Related types
<ul>
<li><a href='#presence-message'>PresenceMessage</a></li>
<li><a href='#presence-action'>Presence action</a></li>
<li><a href='#paginated-result'>PaginatedResult</a></li>
<li><a href='#param'>Param</a></li>
</ul>
</li>
</ul>
</li></ul>
</div><h2>Methods</h2>
<h6 id="get">get</h6>
<p>Get the current presence member set for this channel.  In the REST client library this method directly queries <a href="/rest-api#presence">Ably&#8217;s REST presence API</a></p>
<blockquote class="definition">
<p class="definition"><span lang='default'>get(Object options, callback(<a href="/realtime/types#error-info">ErrorInfo</a> err, <a href="#paginated-result">PaginatedResult</a>&lt;<a href="#presence-message">PresenceMessage</a>&gt; resultPage))</span><span lang='ruby'><a href="#paginated-result">PaginatedResult</a>&lt;<a href="#presence-message">PresenceMessage</a>&gt; get(Hash options)</span><span lang='java'>public <a href="#paginated-result">PaginatedResult</a>&lt;<a href="#presence-message">PresenceMessage</a>&gt; get(<a href="#param">Param</a>[] options)</span><span lang='swift,objc'>get(query: ARTPresenceQuery, cb: (<a href="#presence-message">ARTPresenceMessage</a>, NSError?) &#8594; Void)</span></p>
</blockquote>
<p>Gets an array of members present on the channel as <a href="#presence-message">PresenceMessage</a> objects.</p>
<h4>Parameters</h4>
<dl>
	<dt><span lang="default">options</span><span lang="objc,swift">query</span><span lang="java"><a href="#param">Param</a>[] options</span><span lang="ruby">options</span></dt>
	<dd><span lang="default">an optional object containing query parameters</span><span lang="ruby">an optional set of symbol key and value pairs containing the query parameters</span> as specified below.</dd>
</dl>
<dl>
	<dt><div lang="javascript,nodejs">callback</div></dt>
	<dd>is a function of the form: <code>function(err, "PaginatedResult":#paginated-result&lt;"PresenceMessage":#presence-message&gt; resultPage)</code></dd>
	<dt><div lang="objc,swift">callback</div></dt>
	<dd>called with a <a href="#paginated-result"><code>PaginatedResult</code></a><code>&lt;</code><a href="#presence-message"><code>PresenceMessage</code></a><code>&gt;</code>, or with an error</dd>
</dl>
<h4><span lang="default"><code>options</code> parameters</span><span lang="objc,swift"><code>ARTPresenceQuery</code> properties</span></h4>
<dl>
	<dt><span lang="default"><code>clientId</code></span><span lang="ruby"><code>:client_id</code></span></dt>
	<dd>when provided, will filter array of members returned that match the provided <span lang="default"><a href="/rest/usage#client-id"><code>clientId</code></a></span><span lang="ruby"><a href="/rest/usage#client-id"><code>client_id</code></a></span> string</dd>
	<dt><span lang="default"><code>connectionId</code></span><span lang="ruby"><code>:connection_id</code></span></dt>
	<dd>when provided, will filter array of members returned that match the provided <span lang="default"><a href="/realtime/connection#id"><code>connectionId</code></a></span><span lang="ruby"><a href="/realtime/connection/#id"><code>connection_id</code></a></span> string</dd>
</dl>


<div lang="javascript,nodejs"> <!-- start javascript,nodejs language block -->
<h4>Callback result</h4>
<p>On success, <code>resultPage</code> contains a <a href="#paginated-result"><code>PaginatedResult</code></a> encapsulating an array of <a href="#presence-message"><code>PresenceMessage</code></a> objects corresponding to the current page of members currently present on the channel. <a href="#paginated-result"><code>PaginatedResult</code></a> supports pagination using <a href="#paginated-result"><code>next()</code></a> and <a href="#paginated-result"><code>first()</code></a> methods.</p>
<p>On failure to retrieve the current presence member set, <code>err</code> contains an <a href="#error-info"><code>ErrorInfo</code></a> object with the failure reason.</p>

</div> <!-- /end javascript,nodejs language block -->



<div lang="java,ruby"> <!-- start java,ruby language block -->
<h4>Returns</h4>
<p>On success, the returned <a href="#paginated-result"><code>PaginatedResult</code></a> encapsulates an array of <a href="#presence-message"><code>PresenceMessage</code></a> objects corresponding to the current page of members currently present on the channel. <a href="#paginated-result"><code>PaginatedResult</code></a> supports pagination using <a href="#paginated-result"><code>next</code></a> and <a href="#paginated-result"><code>first</code></a> methods.</p>
<p>Failure to retrieve the current presence member set will raise an <a href="/realtime/types/#ably-exception"><code>AblyException</code></a></p>

</div> <!-- /end java,ruby language block -->

<h6 id="history">history</h6>
<blockquote class="definition">
<p class="definition"><span lang='default'>history(Object option, callback(<a href="/rest/types#error-info">ErrorInfo</a> err, <a href="#paginated-result">PaginatedResult</a>&lt;<a href="#presence-message">PresenceMessage</a>&gt; resultPage))</span><span lang='ruby'><a href="#paginated-result">PaginatedResult</a>&lt;<a href="#presence-message">PresenceMessage</a>&gt; history(Hash option)</span><span lang='java'>public <a href="#paginated-result">PaginatedResult</a>&lt;<a href="#presence-message">PresenceMessage</a>&gt; history(<a href="#param">Param</a>[] option)</span><span lang='objc,swift'>history(query: ARTDataQuery?, callback: (<a href="#paginated-result">ARTPaginatedResult</a>&lt;<a href="#presence-message">ARTPresenceMessage</a>&gt;?, NSError?) &#8594; Void) throws</span></p>
</blockquote>
<p>Gets a <a href="#paginated-result">paginated</a> set of historical presence message events for this channel. If the <a href="https://support.ably.io/support/solutions/articles/3000030059-how-long-are-messages-stored-for">channel is configured to persist messages to disk</a>, then the presence message event history will <a href="https://support.ably.io/solution/articles/3000030059-how-long-are-messages-stored-for">typically be available for 24 &#8211; 72 hours</a>. If not, presence message events are only retained in memory by the Ably service for two minutes.</p>
<h4>Parameters</h4>
<dl>
	<dt><span lang="default">option</span><span lang="java"><a href="#param">Param</a>[] option</span></dt>
	<dd><span lang="default">an optional object containing query parameters</span><span lang="ruby">an optional set of key value pairs containing query parameters</span>, as specified in the <a href="/rest/history#presence-history">presence history API documentation</a>.</dd>
</dl>
<dl>
	<dt><div lang="javascript,nodejs">callback</div></dt>
	<dd>is a function of the form: <code>function(err, resultPage)</code></dd>
	<dt><div lang="swift,objc">callback</div></dt>
	<dd>called with a <a href="#paginated-result">ARTPaginatedResult</a>&lt;<a href="#presence-message">ARTPresenceMessage</a>&gt; object or an error</dd>
</dl>
<p>Further details of the supported <code>option</code> params, see <a href="/rest/history#presence-history">presence history API documentation</a>.</p>


<div lang="javascript,nodejs,,swift,objc"> <!-- start javascript,nodejs,,swift,objc language block -->
<h4>Callback result</h4>
<p>On success, <code>resultPage</code> contains a <a href="#paginated-result"><code>PaginatedResult</code></a> encapsulating an array of <a href="#presence-message"><code>PresenceMessage</code></a> objects corresponding to the current page of results. <a href="#paginated-result"><code>PaginatedResult</code></a> supports pagination using <a href="#paginated-result"><code>next()</code></a> and <a href="#paginated-result"><code>first()</code></a> methods.</p>
<p>On failure to retrieve message history, <code>err</code> contains an <a href="#error-info"><code>ErrorInfo</code></a> object with the failure reason.</p>

</div> <!-- /end javascript,nodejs,,swift,objc language block -->



<div lang="java,ruby"> <!-- start java,ruby language block -->
<h4>Returns</h4>
<p>On success, the returned <a href="#paginated-result"><code>PaginatedResult</code></a> encapsulates an array of <a href="#presence-message"><code>PresenceMessage</code></a> objects corresponding to the current page of results. <a href="#paginated-result"><code>PaginatedResult</code></a> supports pagination using <a href="#paginated-result"><code>next</code></a> and <a href="#paginated-result"><code>first</code></a> methods.</p>
<p>Failure to retrieve the message history will raise an <a href="/realtime/types/#ably-exception"><code>AblyException</code></a></p>

</div> <!-- /end java,ruby language block -->

<h2 id="related-types">Related types</h2>
<h3 id="presence-message"><span lang='default'>PresenceMessage</span><span lang='swift,objc'>ARTPresenceMessage</span><span lang='ruby'>Ably::Models::PresenceMessage</span><span lang='java'>io.ably.lib.types.PresenceMessage</span></h3>
<p>A <code>PresenceMessage</code> represents an individual presence update that is sent to or received from Ably.</p>
<h4><span lang='default'>Properties</span><span lang='java'>Members</span><span lang='ruby'>Attributes</span></h4>
<dl>
	<dt><div lang="java"><code>action</code></div></dt>
	<dd>the event signified by a PresenceMessage. See <a href="/realtime/types#presence-action"><code>PresenceMessage.action</code></a><br><i>Type: enum Action { ABSENT, PRESENT, ENTER, LEAVE, UPDATE }</i></dd>
	<dt><div lang="javascript,nodejs"><code>action</code></div></dt>
	<dd>the event signified by a PresenceMessage. See <a href="/realtime/types#presence-action"><code>Presence action</code></a><br><i>Type: Integer value for Action { &#8220;ABSENT&#8221; : 0, &#8220;PRESENT&#8221; : 1, &#8220;ENTER&#8221; : 2, &#8220;LEAVE&#8221; : 3, &#8220;UPDATE&#8221; : 4 }</i></dd>
	<dt><div lang="ruby"><code>action</code></div></dt>
	<dd>the event signified by a PresenceMessage. See <a href="/realtime/types#presence-action"><code>PresenceMessage::ACTION</code></a><br><i>Type: enum ACTION { :absent, :present, :enter, :leave, :update }</i></dd>
	<dt><div lang="objc,swift"><code>action</code></div></dt>
	<dd>the event signified by a PresenceMessage. See <a href="/realtime/types#presence-action"><code>PresenceMessage.action</code></a><br><i>Type: ARTPresenceAction</i></dd>
</dl>
<dl>
	<dt><div lang="java"><code>data</code></div></dt>
	<dd>The presence update payload, if provided<br><i>Type: String, ByteArray, JSONObject, JSONArray</i></dd>
	<dt><div lang="javascript,nodejs"><code>data</code></div></dt>
	<dd>The presence update payload, if provided<br><i>Type: String, StringBuffer, JSON Object</i></dd>
	<dt><div lang="ruby"><code>data</code></div></dt>
	<dd>The presence update payload, if provided<br><i>Type: String, Binary (ASCII-8BIT String), Hash, Array</i></dd>
	<dt><div lang="swift"><code>data</code></div></dt>
	<dd>The message payload, if provided<br><i>Type: String, NSData, Dictionary, Array</i></dd>
	<dt><div lang="objc"><code>data</code></div></dt>
	<dd>The message payload, if provided<br><i>Type: NSString *, NSData *, NSDictionary *, NSArray *</i></dd>
</dl>
<dl>
	<dt><code>id</code></dt>
	<dd>Unique ID assigned by Ably to this presence update<br><i>Type: String</i></dd>
</dl>
<dl>
	<dt><span lang="default"><code>clientId</code></span><span lang="ruby"><code>client_id</code></span></dt>
	<dd>The client ID of the publisher of this presence update<br><i>Type: String</i></dd>
</dl>
<dl>
	<dt><span lang="default"><code>connectionId</code></span><span lang="ruby"><code>connection_id</code></span></dt>
	<dd>The connection ID of the publisher of this presence update<br><i>Type: String</i></dd>
</dl>
<dl>
	<dt><code>timestamp</code></dt>
	<dd>Timestamp when the presence update was received by the Ably the realtime service, as milliseconds since the epoch<br><i>Type: <span lang="default">Integer</span><span lang="java">Long Integer</span><span lang="ruby">Time</span><span lang="objc,swift">NSDate</span></i></dd>
</dl>
<dl>
	<dt><code>encoding</code></dt>
	<dd>This will typically be empty as all presence updates received from Ably are automatically decoded client-side using this value. However, if the message encoding cannot be processed, this attribute will contain the remaining transformations not applied to the <code>data</code> payload<br><i>Type: String</i></dd>
</dl>
<h3 id="presence-action"><span lang='default'>Presence action</span><span lang='swift,objc'>ARTPresenceAction</span><span lang='java'>io.ably.lib.types.PresenceMessage.Action</span><span lang='ruby'>Ably::Models::PresenceMessage::ACTION</span></h3>


<div lang="javascript,nodejs"> <!-- start javascript,nodejs language block -->
<p><code>Presence</code> <code>action</code> is a String with a value matching any of the <a href="/realtime/presence#presence-states"><code>Realtime Presence</code> states &amp; events</a>.</p>
<pre lang="javascript"><code lang="javascript">var allPresenceActions = [
  'absent', // (reserved for internal use)
  'present',
  'enter',
  'leave',
  'update'
]</code></pre>

</div> <!-- /end javascript,nodejs language block -->



<div lang="java"> <!-- start java language block -->
<p><code>io.ably.lib.types.PresenceMessage.Action</code> is an enum representing all the <a href="/realtime/presence#presence-states"><code>Realtime Presence</code> states &amp; events</a>.</p>
<pre lang="java"><code lang="java">public enum Action {
  ABSENT,  // 0 (reserved for internal use)
  PRESENT, // 1
  ENTER,   // 2
  LEAVE,   // 3
  UPDATE   // 4
}</code></pre>

</div> <!-- /end java language block -->



<div lang="ruby"> <!-- start ruby language block -->
<p><code>Ably::Models::PresenceMessage::ACTION</code> is an enum-like value representing all the <a href="/realtime/presence#presence-states"><code>Realtime Presence</code> states &amp; events</a>. <code>ACTION</code> can be represented interchangeably as either symbols or constants.</p>
<h4>Symbol states</h4>
<pre lang="ruby"><code lang="ruby">:absent  # =&gt; 0 (reserved for internal use)
:present # =&gt; 1
:enter   # =&gt; 2
:leave   # =&gt; 3
:update  # =&gt; 4</code></pre>
<h4>Constant states</h4>
<pre lang="ruby"><code lang="ruby">PresenceMessage::ACTION.Absent  # =&gt; 0 (internal use)
PresenceMessage::ACTION.Present # =&gt; 1
PresenceMessage::ACTION.Enter   # =&gt; 2
PresenceMessage::ACTION.Leave   # =&gt; 3
PresenceMessage::ACTION.Update  # =&gt; 4</code></pre>
<h4>Example usage</h4>
<pre lang="ruby"><code lang="ruby"># Example with symbols
presence.on(:attached) { ... }

# Example with constants
presence.on(Ably::Models::PresenceMessage::ACTION.Enter) { ... }

# Interchangeable
Ably::Models::PresenceMessage::ACTION.Enter == :enter # =&gt; true</code></pre>

</div> <!-- /end ruby language block -->



<div lang="objc,swift"> <!-- start objc,swift language block -->
<p><code>ARTPresenceAction</code> is an enum representing all the <a href="/realtime/presence#presence-states"><code>Realtime Presence</code> states &amp; events</a>.</p>
<pre lang="objc"><code lang="objc">typedef NS_ENUM(NSUInteger, ARTPresenceAction) {
    ARTPresenceAbsent,
    ARTPresencePresent,
    ARTPresenceEnter,
    ARTPresenceLeave,
    ARTPresenceUpdate,
    ARTPresenceLast
};</code></pre>
<pre lang="swift"><code lang="swift">enum ARTPresenceAction : UInt {
  case Absent
  case Present
  case Enter
  case Leave
  case Update
  case Last
}</code></pre>

</div> <!-- /end objc,swift language block -->

<h3 id="paginated-result"><span lang='default'>PaginatedResult</span><span lang='swift,objc'>ARTPaginatedResult</span><span lang='ruby'>Ably::Models::PaginatedResult</span><span lang='java'>io.ably.lib.types.PaginatedResult</span></h3>
<p>A <code>PaginatedResult</code> is a type that represents a page of results for all message and presence history, stats and REST presence requests. The response from a <a href="/rest-api/#pagination">Ably REST API paginated query</a> is accompanied by metadata that indicates the relative queries available to the <code>PaginatedResult</code> object.</p>
<h4><span lang='default'>Properties</span><span lang='java'>Members</span><span lang='ruby'>Attributes</span></h4>
<dl>
	<dt><code>items</code></dt>
	<dd>contains a page of results (for example an Array of <a href="#message"><code>Message</code></a> or <a href="#presence-message"><code>PresenceMessage</code></a> objects for a channel history request)<br><i>Type: Array &lt;Message, Presence, Stats&gt;</i></dd>
</dl>
<dl>
	<dt><div lang="default"><code>isLast</code></div></dt>
	<dd><code>true</code> if this page is the last page<br><i>Type: Boolean</i></dd>
	<dt><div lang="ruby"><code>last?</code></div></dt>
	<dd><code>true</code> if this page is the last page<br><i>Type: Boolean</i></dd>
	<dt><div lang="php"><code>isLast()</code></div></dt>
	<dd><code>true</code> if this page is the last page<br><i>Type: Boolean</i></dd>
</dl>
<dl>
	<dt><div lang="default"><code>hasNext</code></div></dt>
	<dd><code>true</code> if there are further pages<br><i>Type: Boolean</i></dd>
	<dt><div lang="ruby"><code>has_next?</code></div></dt>
	<dd><code>true</code> if there are further pages<br><i>Type: Boolean</i></dd>
	<dt><div lang="php"><code>hasNext()</code></div></dt>
	<dd><code>true</code> if there are further pages<br><i>Type: Boolean</i></dd>
</dl>
<h4>Methods</h4>
<h6>first</h6>
<blockquote class="definition">
<p class="definition"><span lang='default'>first(callback(<a href="/realtime/types#error-info">ErrorInfo</a> err, <a href="/realtime/types#paginated-result">PaginatedResult</a> resultPage))</span><span lang='ruby'><a href="/realtime/types#paginated-result">PaginatedResult</a> first</span><span lang='php'><a href="/realtime/types#paginated-result">PaginatedResult</a> first()</span><span lang='java'>public <a href="/realtime/types#paginated-result">PaginatedResult</a> first()</span><span lang='swift,objc'>first(callback: (ARTPaginatedResult?, NSError?) &#8594; Void)</span></p>
</blockquote>
<p>Returns a new <code>PaginatedResult</code> for the first page of results. <span lang="ruby">When using the Realtime library, the <code>first</code> method returns a <a href="/realtime/types#deferrable">Deferrable</a> and yields a <a href="/realtime/types#paginated-result">PaginatedResult</a>.</span></p>
<h6>items</h6>
<blockquote class="definition">
<p class="definition"><span lang='default'>Object[] items()</span><span lang='ruby'>Object[] items</span><span lang='php'>Object[] items()</span><span lang='java'>public Object[] items()</span><span lang='swift, objc'>items: [AnyObject]</span></p>
</blockquote>
<p>Returns the current page of results as an Array. The type of the objects in the Array is determined by the operation that provided the <code>PaginatedResult</code>. For example, a <a href="/realtime/channels-messages#history">Message#history</a> request will return an array of <code>Message</code> objects.</p>
<h6>next</h6>
<blockquote class="definition">
<p class="definition"><span lang='default'>next(callback(<a href="/realtime/types#error-info">ErrorInfo</a> err, <a href="/realtime/types#paginated-result">PaginatedResult</a> resultPage))</span><span lang='ruby'><a href="/realtime/types#paginated-result">PaginatedResult</a> next</span><span lang='php'><a href="/realtime/types#paginated-result">PaginatedResult</a> next()</span><span lang='java'>public <a href="/realtime/types#paginated-result">PaginatedResult</a> next()</span><span lang='swift,objc'>next(callback: (ARTPaginatedResult?, NSError?) &#8594; Void)</span></p>
</blockquote>
<p>Returns a new <code>PaginatedResult</code> loaded with the next page of results. If there are no further pages, then <span lang="default"><code>null</code></span><span lang="java"><code>Null</code></span><span lang="ruby,objc,swift"><code>nil</code></span> is returned. <span lang="ruby">When using the Realtime library, the <code>first</code> method returns a <a href="/realtime/types#deferrable">Deferrable</a> and yields a <a href="/realtime/types#paginated-result">PaginatedResult</a>.</span></p>
<h4>Example</h4>
<pre lang="javascript"><code lang="javascript">channel.history(function(err, paginatedResult) {
  console.log('Page 0 item 0:' + paginatedResult.items[0].data);
  paginatedResult.next(function(err, nextPage) {
    console.log('Page 1 item 1: ' + nextPage.items[1].data);
    console.log('Last page?: ' + nextPage.isLast;
  });
});</code></pre>
<pre lang="nodejs"><code lang="nodejs">channel.history(function(err, paginatedResult) {
  console.log('Page 0 item 0:' + paginatedResult.items[0].data);
  paginatedResult.next(function(err, nextPage) {
    console.log('Page 1 item 1: ' + nextPage.items[1].data);
    console.log('Last page?: ' + nextPage.isLast;
  });
});</code></pre>
<pre lang="java"><code lang="java">PaginatedResult firstPage = channel.history();
System.out.println("Page 0 item 0:" + firstPage.items[0].data);
if (firstPage.hasNext) {
  PaginatedResult nextPage = firstPage.next();
  System.out.println("Page 1 item 1:" + nextPage.items[1].data);
  System.out.println("More pages?:" + Strong.valueOf(nextpage.hasNext()));
});</code></pre>
<pre lang="ruby"><code lang="ruby"># When using the REST sync library
first_page = channel.history
puts "Page 0 item 0: #{first_page.items[0].data}"
if first_page.has_next?
  next_page = first_page.next
  puts "Page 1 item 1: #{next_page.items[1].data}"
  puts "Last page?: #{next_page.is_last?}"
end

# When using the Realtime EventMachine library
channel.history do |first_page|
  puts "Page 0 item 0: #{first_page.items[0].data}"
  if first_page.has_next?
    first_page.next do |next_page|
      puts "Page 1 item 1: #{next_page.items[1].data}"
      puts "Last page?: #{next_page.is_last?}"
    end
  end
end</code></pre>
<pre lang="php"><code lang="php">$firstPage = $channel.history();
echo("Page 0 item 0: " . $firstPage-&gt;items[0]-&gt;data);
if ($firstPage-&gt;hasNext()) {
  $nextPage = $firstPage-&gt;next();
  echo("Page 1 item 1: " . $nextPage-&gt;items[1]-&gt;data);
  echo("Last page?: " . $nextPage-&gt;isLast());
}</code></pre>
<pre lang="objc"><code lang="objc">[channel history:^(ARTPaginatedResult&lt;ARTMessage *&gt; *paginatedResult, NSError *error) {
    NSLog(@"Page 0 item 0: %@", paginatedResult.items[0].data);
    [paginatedResult next:^(ARTPaginatedResult&lt;ARTMessage *&gt; *nextPage, NSError *error) {
        NSLog(@"Page 1 item 1: %@", nextPage.items[1].data);
        NSLog(@"Last page?: %d", nextPage.isLast);
    }];
}];</code></pre>
<pre lang="swift"><code lang="swift">channel.history { paginatedResult, error in
    let paginatedResult = paginatedResult!
    print("Page 0 item 0: \((paginatedResult.items[0] as! ARTMessage).data)")
    paginatedResult.next { nextPage, error in
        let nextPage = nextPage!
        print("Page 0 item 0: \((nextPage.items[1] as! ARTMessage).data)")
        print("Last page? \(nextPage.isLast)")
    }
}</code></pre>
<h3 id="param"><span lang='java'>io.ably.lib.types.Param</span></h3>


<div lang="java"> <!-- start java language block -->
<p><code>Param</code> is a type encapsulating a key/value pair. This type is used frequently in method parameters allowing key/value pairs to be used more flexible, see <a href="/realtime/history#channel-history"><code>Channel#history</code></a> for an example.</p>
<p>Please note that <code>key</code> and <code>value</code> attributes are always strings. If an <code>Integer</code> or other value type is expected, then you must coerce that type into a <code>String</code>.</p>
<h4><span lang='java'>Members</span></h4>
<dl>
	<dt><code>key</code></dt>
	<dd>The key value<br><i>Type: String</i></dd>
	<dt><code>value</code></dt>
	<dd>The value associated with the <code>key</code><br><i>Type: String</i></dd>
</dl>

</div> <!-- /end java language block -->


    </article>
    <hr class="back">
    <a href="#documentation">Back to top</a>
  </div>
  <div id="sidebar">
  <a href="/" title="API Documentation Home"><img src="/images/ably-logo.png" class="ably-logo" title="API Documentation Home"></a>
  <ul>
<li class=''><a href='/quick-start-guide/'>Quickstart Guide</a></li>
<li class=''><a href='/how-ably-works/'>How Ably works</a></li>
</ul>
  <h2><a href="/realtime/">Realtime client lib</a></h2>
<ul>
<li class=''><a href='/realtime/usage/'>Using the Realtime library</a></li>
<li class=''><a href='/realtime/connection/'>Connection</a></li>
<li class=''><a href='/realtime/channels-messages/'>Channels and Messages</a></li>
<li class=''><a href='/realtime/presence/'>Presence</a></li>
<li class=''><a href='/realtime/authentication/'>Authentication</a></li>
<li class=''><a href='/realtime/history/'>History</a></li>
<li class=''><a href='/realtime/encryption/'>Encryption</a></li>
<li class=''><a href='/realtime/statistics/'>Statistics</a></li>
<li class=''><a href='/realtime/types/'>Types</a></li>
</ul>
  <h2><a href="/rest/">REST client lib</a></h2>
<ul>
<li class=''><a href='/rest/usage/'>Using the REST library</a></li>
<li class=''><a href='/rest/channels-messages/'>Channels and Messages</a></li>
<li class='selected'><a href='/rest/presence/'>Presence</a></li>
<li class=''><a href='/rest/authentication/'>Authentication</a></li>
<li class=''><a href='/rest/history/'>History</a></li>
<li class=''><a href='/rest/encryption/'>Encryption</a></li>
<li class=''><a href='/rest/statistics/'>Statistics</a></li>
<li class=''><a href='/rest/types/'>Types</a></li>
</ul>
  <h2><a href="/rest-api/">REST API</a></h2>
<ul>
</ul>
  <h2>General</h2>
<ul>
<li class=''><a href='/general/authentication/'>Authentication</a></li>
<li class=''><a href='/general/channel-rules-namespaces/'>Channel Rules and Namespaces</a></li>
<li class=''><a href='/general/push-notifications/'>Mobile push notifications</a></li>
<li class=''><a href='/general/webhooks/'>Receiving WebHooks</a></li>
<li class=''><a href='/general/statistics/'>Application Statistics</a></li>
</ul>
  <h2><a href="/client-lib-development-guide/">Library Development</a></h2>
<ul>
<li class=''><a href='/client-lib-development-guide/features/'>Features spec v0.8</a></li>
<li class=''><a href='/client-lib-development-guide/feature-prioritisation/'>Feature prioritisation</a></li>
<li class=''><a href='/client-lib-development-guide/protocol/'>Realtime Protocol Definition</a></li>
<li class=''><a href='/client-lib-development-guide/rest-api/'>REST API Definition</a></li>
<li class=''><a href='/client-lib-development-guide/test-api/'>Sandbox Test API</a></li>
<li class=''><a href='/client-lib-development-guide/encryption/'>Encryption</a></li>
<li class=''><a href='/client-lib-development-guide/websocket/'>WebSocket Transport</a></li>
<li class=''><a href='/client-lib-development-guide/comet/'>Comet Transport</a></li>
<li class=''><a href='/client-lib-development-guide/connection-recovery/'>Connection Recovery</a></li>
<li class=''><a href='/client-lib-development-guide/connection-manager/'>Connection Manager</a></li>
<li class=''><a href='/client-lib-development-guide/connection-fallback/'>Connection host fallback</a></li>
<li class=''><a href='/client-lib-development-guide/documentation-formatting-guide/'>Documentation Formatting Guide</a></li>
<li class=''><a href='/code-index/'>Code Examples List</a></li>
</ul>
  <ul>
<li><a href="https://www.ably.io">Visit Ably.io</a></li>
</ul>
</div>

</body>
</html>
