---
title: Usage
section: realtime
index: 10
jump_to:
  Help with:
    - Usage#title
  API reference:
    - Constructor
---

The Realtime client library is available in "multiple languages":https://ably.io/download/realtime-client-libraries with a
consistent API across all languages.  You can view this documentation in each supported language using the
language selector navigation.

<div lang="nodejs"> The REST library for Javascript targets node.js clients and servers. It is obtainable as a module
direcly from npm using

bc[sh]. npm install ably-js

The ably-js module contains both REST and Realtime libraries, and the REST library is a subset of Realtime; however,
each is exported separately by the module:

bc[javascript]. var Ably = require('ably-js');

The Realtime constructor is "@Ably.Realtime@":#constructor; the REST constructor is "@Ably.Rest@":/rest.

</div>

<div lang="ruby"> The Realtime library for Ruby is obtainable as a RubyGem direcly using

bc[sh]. gem install ably-realtime

If using bundler, simply add the following to your Gemfile and run @bundle install@:

bc[ruby]. gem 'ably-realtime'

</div>

<div lang="java"> The Realtime library for Java is downloadable as a JAR from
"https://github.com/ably/ably-java/bin":https://github.com/ably/ably-java/bin

Ensure this JAR is included in your class path.

bc[java]. import io.ably.rest.AblyRealtime;

</div>

h1. Realtime Object Reference

h2(#constructor). Constructor

h6[nodejs]. new Ably.Realtime(options)

h6[ruby]. Ably::Realtime.new(options)

h6[java]. new AblyRealtime(options)

Operations are performed after first instancing the library:

bc[nodejs]. var Ably = require('ably-js'), Realtime = new Ably.Realtime(options);

bc[ruby]. realtime = Ably::Realtime.new(options)

bc[java]. AblyRealtime realtime = new AblyRealtime(options)

The Realtime library may be instanced multiple times with different @options@ in any given context. Except where specified
otherwise, instances operate independently of one another.

The set of all supported options is given below.

h2. Overview

The Realtime library attempts to establish, and maintain, a single connection to the Ably realtime service. The library
extends, and depends on, the REST library, which provides access to the REST-based Ably APIs, and the Auth API in
particular.

Whereas the REST API is stateless, the Realtime API maintains connection and channel state.

h3. Essential options

The Realtime library needs to know the application identifier, or @appId@, and also requires credentials or other
information required to be able to authenticate to the Ably service. The application id can be specified explicitly with
an @appId@ option, or is more typically given implicitly by passing a @key@ or @token@ option when constructing the
library.

The @key@ option takes a key string, as obtained from the "application dashboard":https://ably.io/dashboard. Use this
option if you wish to use Basic authentication, or if you want to be able to request tokens without needing to defer to
a separate entity to sign token requests. Note that initialising the library with a @key@ does not necessarily mean that
the library will use Basic auth; but knowing the key it is able to create and sign token requests and use token
authentication when necessary.

The @token@ option takes a token string, and assumes the token has been obtained from some other instance that requested
the token. Use the token option if you are provided with a token to use and you do not have a key (or do not have a key
with the capabilities that you require).

Since tokens are short-lived, it is rarely sufficient to start with a token, without the means for refreshing it. The
@authUrl@ and @authCallback@ options are provided to allow a user of the library to issue new token requests as
required; these options even permit the library to be instanced without either @key@ or @token@, and an initial token
will be obtained when required.

- appId := The application id. This option is only required if the application id cannot be inferred either from a @key@
or @token@ option. If given, it is the application id as indicated on the "application
dashboard":https://ably.io/dashboard.

- key := The full key string, as obtained from the "application
dashboard":https://ably.io/dashboard. Use this option if you wish to use Basic auth, or wish to be able to issue tokens
without needing to defer to a separate entity to sign token requests.

- token := A token string, as the value of the
@id@ property of a @token_details@ component of a token response.

- authCallback := <span lang="nodejs">A Javascript
function to call when a new token is required.</span><span lang="ruby">A function to call when a new token is
required</span> The role of the callback is to generate a signed @token request@ this is then submitted by the library
to the @requestToken@ API. See below for the callback function signature.

- authUrl := A URL that the library may use to
obtain a signed token request. For example, this can be used by a client to obtain signed token requests from an
application server.

- authHeaders := A set of headers to be added to any request made to the @authUrl@.  Useful when an
application requires these to be added to validate the request or implement the response.

- authParams := A set of
@POST@ params to be added to any request made to the @authUrl@.  Useful when an application require these to be added to
validate the request or implement the response.

h3. Other options

The following further options are supported by the library.

- encrypted := _false, or in the case of a browser client, to the state of the document that loaded the library_ A
boolean value, indicating whether or not a TLS ("SSL") secure connection should be used.  Note that unpaid Ably accounts
are unable to use encrypted Real-time connections.

- clientId := A client id, used for identifying this client for
presence purposes. The clientId can be any string. This option is primarily intended to be used in situations where the
library is instanced with a key; note that a clientId may also be implicit in a token used to instance the library; an
error will be raised if a clientId specified here conflicts with the clientId implicit in the token.

- log := Parameters to control the log output of the library. The supplied value must be an object that may contain one or both of the
following entries:
 @level@: a number controlling the verbosity of the output from 1 (minimum, errors only) to 4 (most verbose);
 @handler@: a function to handle each line of log output. If @handler@ is not specified, @console.log@ is
used.
Note that the log level and log handler may be global or static variables in the library and may thus not act independently
between library instances.

- transports := In those environments supporting multiple transports, an array of transports to use, in descending order
of preference. In the browser environment the available transports are:
@web_socket@, @flash_socket@, @xhr@, @jsonp@.

- useTextProtocol := false. The browser client library detects whether or not the browser has the capability to use the
binary protocol, and enables this option if the browser requires the use of the text protocol.

- queueMessages := true. If false, this disables the default behaviour whereby the library queues messages on a connection
in the disconnected or suspended states. The default behaviour allows applications to submit messages immediately upon
instancing the library, without having to wait for the connection to be established. Applications may use this option to
disable that behaviour if they wish to have application-level control over the queueing under those conditions.

- recover := This option allows a connection to inherit the state of a previous connection that may have existed under an
different instance of the Realtime library. This might typically be used by clients of the browser library to ensure
connection state can be preserved when the user refreshes the page. See connection_state_recovery for further information
on this option.

h2. Methods

connect. Causes the library to re-attempt connection, if it was previously explicitly closed by the user, or was closed as
a result of an unrecoverable error. Note that it is not necessary to call connect() to establish a connection when the realtime
library is first instanced.

close. Causes the connection to close, entering the closed state. Once closed, the library will not attempt to re-establish
the connection without a call to connect().

h2. Members

connection. A reference to the connection object.

channels. The collection of channels instanced, indexed by channel name. See channels_and_messages for more information.