<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Ably API Documentation - Presence</title>
    <link rel="shortcut icon" href="/assets/favicon.ico">

    <link rel="stylesheet" type="text/css" href="/assets/vendor/prettify/prettify.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/assets/stylesheet.css" media="screen">

    <script src="/assets/vendor/javascripts/jquery-1-8-3-min.js" type="text/javascript"></script>
    <script src="/assets/vendor/javascripts/jquery-cookie-1-3-1.js" type="text/javascript"></script>
    <script src="/assets/vendor/javascripts/base64.js" type="text/javascript"></script>

    <script src="/assets/vendor/prettify/prettify-lib.js" type="text/javascript"></script>

    <script src="//cdn.ably.io/lib/ably.min.js" type="text/javascript"></script>

    <script src="/assets/javascripts/application.js" type="text/javascript"></script>
    <script src="/assets/javascripts/lang-manager.js" type="text/javascript"></script>

    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="nanoc 3.7.5">
  </head>
  <body>
    <div class="canonical-notice">
      <img src="/assets/icon-alert.png">
      <span class="canonical-notice-text">
        You are viewing our bleeding edge unstable documentation. We recommend you use of our <a href="https://www.ably.io/documentation">stable documentation Â»</a>
      </span>
      <img src="/assets/icon-alert.png">
    </div>
    <div class="fork-banner"><a href="https://github.com/ably/docs"><img src="/assets/forkme.png" alt="Fork me on GitHub"></a></div>

  <div id="documentation">
    
      <nav class="jump-to-nav">
        <div class="form">
          <select id="jump-to-nav">
            <option>Jump to ...</option>
            <optgroup label='Help with'>
<option id="anchor-title">Presence</option>
</optgroup>
<optgroup label='Presence API reference'>
<option id="anchor-enter">enter</option>
<option id="anchor-enter-client">enterClient</option>
<option id="anchor-update">update</option>
<option id="anchor-update-client">updateClient</option>
<option id="anchor-leave">leave</option>
<option id="anchor-leave-client">leaveClient</option>
<option id="anchor-subscribe">subscribe</option>
<option id="anchor-unsubscribe">unsubscribe</option>
<option id="anchor-get">get</option>
</optgroup>
<optgroup label='Related types'>
<option id="anchor-presence-message">PresenceMessage</option>
<option id="anchor-presence-listener">PresenceListener</option>
</optgroup>
          </select>
        </div>
      </nav>
    
    <header>
      
        <div class="breadcrumb"><a href="/realtime/">Realtime Client Library API</a><span class="separator">/</span></div>
      
      
        <h1 id="title">Presence</h1>
      
    </header>
    <article>
      <p>Presence provides awareness of other clients that are connected and present on a channel. Each member present on a channel has a unique client identifier and an optional payload that can be used to describe the member&#8217;s status or attributes. Presence allows you to quickly build apps such as chat rooms or multiplayer games as Ably will automatically keep track of who is present in real time across any device.</p>
<h3>Broadcast your presence &amp; subcribe to presence events</h3>
<p>Ably Channels support the concept of presence. Each channel may have a presence set associated with it, which is a set of clientIds for those clients that have announced their presence by entering the channel.</p>
<pre lang="ruby"><code lang="ruby">EventMachine.run do
  client = Ably::Realtime::Client.new(api_key: '', client_id: 'bob')

  client.channel('realtime-chat').attach do |channel|
    channel.presence.on(:enter) do |presence_message|
      puts "#{presence_message.client_id} entered realtime-chat"
    end

    channel.presence.enter
  end
end</code></pre>
<pre lang="javascript"><code lang="javascript">var client = Ably.Realtime.Client({ key: '', clientId: 'bob' });

client.channel('realtime-chat').attach(function(channel) {
  channel.presence.on('enter', function(presenceMessage) {
    console.log(presenceMessage.memberKey() + ' entered realtime-chat');
  });

  channel.presence.enter();
});</code></pre>
<pre lang="nodejs"><code lang="nodejs">var client = Ably.Realtime.Client({ key: '', clientId: 'bob' });

client.channel('realtime-chat').attach(function(channel) {
  channel.presence.on('enter', function(presenceMessage) {
    console.log(presenceMessage.memberKey() + ' entered realtime-chat');
  });

  channel.presence.enter();
});</code></pre>
<p>A client must be attached to a channel, and must have the relevant permission, in order to enter. Although, the library implicitly calls <span lang="ruby">#attach</span><span lang="javascript,nodejs">attach()</span> if the client is not attached at the time <span lang="javascript,nodejs">enter()</span> is called.</p>
<p>A given <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span> might be present multiple times, via different connections. As far as Ably is concerned these are different members of the presence set. A member of the presence set is, therefore, the combination of a <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span> string and a <span lang="javascript,nodejs">memberId</span><span lang="ruby">member_id</span> string unique to a connection.</p>
<h3>Managing multiple client ID</h3>
<p>An Ably client instance might, if on an application server for example, publish messages on behalf of multiple distinct clientIds. The channel&#8217;s <code>presence</code> object therefore also supports methods that enable presence messages to be published for a clientId specified at the time of the call, rather than for a clientId specified when the library was instanced.</p>
<p>In order to be able to publish presence changes for arbitrary clientIds, the client library must have been instanced either with a key, or with a token bound to the wildcard clientId.</p>
<pre lang="ruby"><code lang="ruby">channel = client.channel('realtime-chat')

channel.presence.on(:enter) do |presence_message|
  puts "#{presence_message.client_id} entered realtime-chat"
end

channel.presence.enter_client('bob') # bob entered realtime-chat
channel.presence.enter_client('mary') # mary entered realtime-chat</code></pre>
<pre lang="javascript"><code lang="javascript">var channel = client.channel('realtime-chat');

channel.presence.on('enter', function(presenceMessage) {
  console.log(presenceMessage.client_id + 'entered realtime-chat');
});

channel.presence.enterClient('bob'); // bob entered realtime-chat
channel.presence.enterClient('mary'); // mary entered realtime-chat</code></pre>
<pre lang="nodejs"><code lang="nodejs">var channel = client.channel('realtime-chat');

channel.presence.on('enter', function(presenceMessage) {
  console.log(presenceMessage.client_id + 'entered realtime-chat');
});

channel.presence.enterClient('bob'); // bob entered realtime-chat
channel.presence.enterClient('mary'); // mary entered realtime-chat</code></pre>
<p>In this example, you have to connect with a different client ID. Submitting the same client ID wouldn&#8217;t submit any other <code>ENTER</code> event.</p>
<pre lang="ruby"><code lang="ruby">channel.presence.on(:enter) do |presence_message|
  puts "#{presence_message.client_id} entered realtime-chat"
end

channel.presence.enter_client('bob') # bob entered realtime-chat
channel.presence.enter_client('bob') # (this prints nothing)</code></pre>
<pre lang="javascript"><code lang="javascript">channel.presence.on('enter', function(presenceMessage) {
  console.log(presenceMessage.clientId + " entered realtime-chat");
});

channel.presence.enterClient('bob'); // bob entered realtime-chat
channel.presence.enterClient('bob'); // (this prints nothing)</code></pre>
<pre lang="nodejs"><code lang="nodejs">channel.presence.on('enter', function(presenceMessage) {
  console.log(presenceMessage.clientId + " entered realtime-chat");
});

channel.presence.enterClient('bob'); // bob entered realtime-chat
channel.presence.enterClient('bob'); // (this prints nothing)</code></pre>
<h3>Payload</h3>
<p>In addition to the <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span> for members on a channel, it is also possible to include a data payload. Clients can <a href="#update">update</a> their data at any point whilst present on a channel.</p>
<pre lang="ruby"><code lang="ruby">channel.presence.on(:enter) do |presence_message|
  puts presence_message.client_id # =&gt; bob
  puts presence_message.data      # =&gt; robert@example.com
end

channel.presence.enter(client_id: 'bob', data: 'robert@example.com')</code></pre>
<pre lang="javascript"><code lang="javascript">channel.presence.on('enter', function(presenceMessage) {
  console.log(presenceMessage.clientId); // =&gt; bob
  console.log(presenceMessage.data);     // =&gt; robert@example.com
});
end

channel.presence.enter({ clientId: 'bob', data: 'robert@example.com' })</code></pre>
<pre lang="nodejs"><code lang="nodejs">channel.presence.on('enter', function(presenceMessage) {
  console.log(presenceMessage.clientId); // =&gt; bob
  console.log(presenceMessage.data);     // =&gt; robert@example.com
});
end

channel.presence.enter({ clientId: 'bob', data: 'robert@example.com' })</code></pre>
<p>A number of presence actions are therefore defined.</p>
<dl>
	<dt>enter</dt>
	<dd>A clientId, or a clientId/memberId combination, is entering the presence channel.</dd>
</dl>
<dl>
	<dt>leave</dt>
	<dd>A clientId, or a clientId/memberId combination, is leaving the presence channel.</dd>
</dl>
<dl>
	<dt>update</dt>
	<dd>An already-present clientId or clientId/memberId combination has been updated.</dd>
</dl>
<dl>
	<dt>present</dt>
	<dd>An already-present clientId or clientId/memberId combination is signaling its presence on the channel. (happens only when a listener is bound to the channel)</dd>
</dl>
<h3>Presence list</h3>
<p>A Channel&#8217;s <code>presence</code> <span lang="default">property</span><span lang="java">field</span> exposes a <code>get</code> method whereby a client can discover the set of all members present on the channel.</p>
<pre lang="ruby"><code lang="ruby">channel.presence.get do |members|
  puts "There are #{members.size} members on this channel"
end</code></pre>
<pre lang="javascript"><code lang="javascript">channel.presence.get(function(members) {
  console.log("There are " + members.length + " members on this channel")
});</code></pre>
<pre lang="nodejs"><code lang="nodejs">channel.presence.get(function(members) {
  console.log("There are " + members.length + " members on this channel")
});</code></pre>
<p>The client keeps track of the presence set from the time that the channel is attached; a up to date presence set is delivered to the client following attach, and the presence set is updated on each message seen subsequently. Thus this <code>get</code> method synchronously returns the already-known presence set, and does not trigger a new request to the Ably service.</p>
<h3>Presence History</h3>
<p>The <code>Presence</code> API exposes a <code>history</code> method whereby a client can obtain presence updates previously sent on the channel. It provides access to the persisted history, as with the REST API, but also enables access to instantaneous or &#8220;live&#8221; history for attached channels.</p>
<p>This live history provides the ability to obtain continuous presence history up to the point that a realtime channel was attached and also supports recent history for channels that do not have persistence enabled.</p>
<p>History results are paginated and therefore accompanied with one or more relative links relating to the current query. Where the number of results returned exceeds the query limit &#8211; which is either the value of the <code>limit</code> param or the default limit of 100 &#8211; the query result contains pages with the limited number of records, and a relative link to the next page.</p>
<pre lang="ruby"><code lang="ruby">channel.presence.history(direction: :backwards) do |messages|
  messages.each do |presence_message|
    puts "#{presence_message.action}: #{presence_message.client_id}"
  end
end</code></pre>
<pre lang="javascript"><code lang="javascript">var params = {direction: 'backwards', limit: '100'};

channel.presence.history(params, function(err, messages, rel) {
  if(err) {
    console.log('Unable to get presence history; err = ' + err.message);
  } else {
    console.log(messages.length + ' presence messages received in first result');
    if(rel &amp;&amp; rel.next) {
      channel.presence.history(rel.next, function(...) { ... });
    }
});</code></pre>
<pre lang="nodejs"><code lang="nodejs">var params = {direction: 'backwards', limit: '100'};

channel.presence.history(params, function(err, messages, rel) {
  if(err) {
    console.log('Unable to get presence history; err = ' + err.message);
  } else {
    console.log(messages.length + ' presence messages received in first result');
    if(rel &amp;&amp; rel.next) {
      channel.presence.history(rel.next, function(...) { ... });
    }
});</code></pre>
<pre lang="java"><code lang="java">import io.ably.types.PresenceMessage;
import io.ably.types.Param;
import io.ably.types.PaginatedResult;

Param[] params = new Param[] {
  new Param("direction", "backwards"),
  new Param("limit", 100)
};

PaginatedResult&lt;PresenceMessage&gt; messages = channel.presence.history(params);
System.out.println(messages.asArray().length + " presence messages received in first result");

if(messages.getNext()) {
  PaginatedResult&lt;PresenceMessage&gt; nextPage = channel.presence.history(messages.getNext());
  System.out.println(...);
}</code></pre>
<p>See the <a href="/realtime/history">history</a> documentation for further details of the supported query parameters.</p>
<h1>API Reference</h1>
<div class="inline-toc">
<ul><li>Presence reference
<ul>
<li>
Methods
<ul>
<li><a href='#enter'>enter</a></li>
<li><a href='#enter-client'>enterClient</a></li>
<li><a href='#update'>update</a></li>
<li><a href='#update-client'>updateClient</a></li>
<li><a href='#leave'>leave</a></li>
<li><a href='#leave-client'>leaveClient</a></li>
<li><a href='#subscribe'>subscribe</a></li>
<li><a href='#unsubscribe'>unsubscribe</a></li>
<li><a href='#get'>get</a></li>
<li><a href='#history'>history</a></li>
</ul>
</li>
<li>
Related types
<ul>
<li><a href='#presence-message'>PresenceMessage</a></li>
<li><a href='#presence-listener'>PresenceListener</a></li>
</ul>
</li>
</ul>
</li></ul>
</div><h2>Methods</h2>
<h6 lang="default" id="enter">enter(clientData, callback)</h6>
<h6 lang="java" id="enter">public void enter(Object clientData, CompletionListener listener)</h6>
<p>Enter this presence channel. The Ably library must have been initialised with a <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span>, and must have been supplied either with a key, or a token bound to that <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span>.</p>
<p>This method sends a <code>PresenceMessage</code> for the client&#8217;s <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span> and optional <span lang="javascript,nodejs">clientData</span><span lang="ruby">client_data</span>. A <span lang="default">callback</span><span lang="java">listener</span> may optionally be passed in to this call to be notified of success or failure of the operation.</p>
<h4>Parameters</h4>
<dl>
	<dt><span lang="java">Object</span>clientData</dt>
	<dd>An optional payload for the message.</dd>
</dl>
<dl>
	<dt><div lang="javascript,nodejs">callback</div></dt>
	<dd>Callback to be called on completion.</dd>
</dl>
<dl>
	<dt><div lang="java">listener</div></dt>
	<dd>Listener to be notified on completion.</dd>
</dl>
<h6 lang="default" id="enter-client">enterClient(clientId, clientData, callback)</h6>
<h6 lang="java" id="enter-client">public void enter(String clientId, Object clientData, CompletionListener listener)</h6>
<p>Enter this presence channel for the given clientId. This method is provided to support connections (eg connections from application server instances) that act on behalf of multiple clientIds. In order to be able to enter the channel with this method, the Ably library must have been instanced either with a key, or with a token bound to the wildcard clientId.</p>
<p>This method sends a <code>PresenceMessage</code> for the given <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span> and optional <span lang="javascript,nodejs">clientData</span><span lang="ruby">client_data</span>. A <span lang="default">callback</span><span lang="java">listener</span> may optionally be passed in to this call to be notified of success or failure of the operation.</p>
<h4>Parameters</h4>
<dl>
	<dt><span lang="java">String</span>clientId</dt>
	<dd>The clientId for the message.</dd>
</dl>
<dl>
	<dt><span lang="java">Object</span>clientData</dt>
	<dd>An optional payload for the message.</dd>
</dl>
<dl>
	<dt><div lang="javascript,nodejs">callback</div></dt>
	<dd>Callback to be called on completion.</dd>
</dl>
<dl>
	<dt><div lang="java">listener</div></dt>
	<dd>Listener to be notified on completion.</dd>
</dl>
<h6 lang="default" id="update">update(clientData, callback)</h6>
<h6 lang="java" id="update">public void update(Object clientData, CompletionListener listener)</h6>
<p>Update the presence data for this client. The Ably library must have been initialised with a <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span>, and must have been supplied either with a key, or a token bound to that <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span>.</p>
<p>This method sends a <code>PresenceMessage</code> for the client&#8217;s <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span> and optional <span lang="javascript,nodejs">clientData</span><span lang="ruby">client_data</span>. A <span lang="default">callback</span><span lang="java">listener</span> may optionally be passed in to this call to be notified of success or failure of the operation.</p>
<h4>Parameters</h4>
<dl>
	<dt><span lang="java">Object</span>clientData</dt>
	<dd>An optional payload for the message.</dd>
</dl>
<dl>
	<dt><div lang="javascript,nodejs">callback</div></dt>
	<dd>Callback to be called on completion.</dd>
</dl>
<dl>
	<dt><div lang="java">listener</div></dt>
	<dd>Listener to be notified on completion.</dd>
</dl>
<h6 lang="default" id="update-client">updateClient(clientId, clientData, callback)</h6>
<h6 lang="java" id="update-client">public void updateClient(String clientId, Object clientData, CompletionListener listener)</h6>
<p>Enter update the <span lang="javascript,nodejs">clientData</span><span lang="ruby">client_data</span> for the given present clientId on this presence channel. This is the analogue of <span lang="javascript,nodejs">enterClient</span><span lang="ruby">enter_client</span>, for the update action.</p>
<h4>Parameters</h4>
<dl>
	<dt><span lang="java">String</span>clientId</dt>
	<dd>The clientId for the message.</dd>
</dl>
<dl>
	<dt><span lang="java">Object</span>clientData</dt>
	<dd>An optional payload for the message.</dd>
</dl>
<dl>
	<dt><div lang="javascript,nodejs">callback</div></dt>
	<dd>Callback to be called on completion.</dd>
</dl>
<dl>
	<dt><div lang="java">listener</div></dt>
	<dd>Listener to be notified on completion.</dd>
</dl>
<h6 lang="default" id="leave">leave(callback)</h6>
<h6 lang="java" id="leave">public void leave(CompletionListener listener)</h6>
<p>Leave this presence channel. This is subject to the same authentication requirements as the <a href="#enter">enter</a> method above.</p>
<p>This method sends a <code>PresenceMessage</code> for the client&#8217;s <span lang="javascript,nodejs">clientId</span><span lang="ruby">client_id</span> and optional <span lang="javascript,nodejs">clientData</span><span lang="ruby">client_data</span>. A <span lang="default">callback</span><span lang="java">listener</span> may optionally be passed in to this call to be notified of success or failure of the operation.</p>
<h4>Parameters</h4>
<dl>
	<dt><div lang="javascript,nodejs">callback</div></dt>
	<dd>Callback to be called on completion.</dd>
</dl>
<dl>
	<dt><div lang="java">listener</div></dt>
	<dd>Listener to be notified on completion.</dd>
</dl>
<h6 lang="default" id="leave-client">leaveClient(clientId, callback)</h6>
<h6 lang="java" id="leave-client">public void leaveClient(String clientId, CompletionListener listener)</h6>
<p>This is the analogue of <a href="#enter-client">enterClient</a>, for the <code>leave</code> action.</p>
<h4>Parameters</h4>
<dl>
	<dt><span lang="java">String</span>clientId</dt>
	<dd>The clientId for the message.</dd>
</dl>
<dl>
	<dt><div lang="javascript,nodejs">callback</div></dt>
	<dd>Callback to be called on completion.</dd>
</dl>
<dl>
	<dt><div lang="java">listener</div></dt>
	<dd>Listener to be notified on completion.</dd>
</dl>
<h6 lang="default" id="subscribe">subscribe(listener)</h6>
<h6 lang="java" id="subscribe">public void subscribe(PresenceListener listener)</h6>
<p>Subscribe to presence messages for this channel. The caller supplies <span lang="default">a listener function</span><span lang="java">an implementation of the PresenceListener interface</span>, which is called each time one or more messages arrives on the channel.</p>
<h4>Parameters</h4>
<dl>
	<dt><div lang="javascript,nodejs">listener</div></dt>
	<dd>The listener function to call for each message.</dd>
</dl>
<dl>
	<dt><div lang="java">listener</div></dt>
	<dd>The MessageListener to be notified on completion.</dd>
</dl>
<h6 lang="default" id="unsubscribe">unsubscribe(listener)</h6>
<h6 lang="java" id="unsubscribe">public void unsubscribe(PresenceListener listener)</h6>
<p>Unsubscribe a previously subscribed listener.</p>
<h4>Parameters</h4>
<dl>
	<dt><div lang="javascript,nodejs">listener</div></dt>
	<dd>The listener function registered on subscription.</dd>
</dl>
<dl>
	<dt><div lang="java">listener</div></dt>
	<dd>The PresenceListener registered on subscription.</dd>
</dl>
<h6 lang="default" id="get">get()</h6>
<h6 lang="java" id="get">public PresenceMessage[] get()</h6>
<p>Get the current presence set for this channel. This returns synchronously with the presence set already known by the client.</p>
<h6 id="history">history</h6>
<blockquote class="definition">
<p class="definition"><span lang='javascript,nodejs'>presence.history(params, callback)</span><span lang='ruby'>presence.history(options) â json_result</span><span lang='java'>public PaginatedResult&lt;PresenceMessage&gt; history(Param[] params)</span></p>
</blockquote>
<p>Get presence history for this channel.</p>
<h4>Parameters</h4>
<dl>
	<dt>params</dt>
	<dd>an optional object containing the query parameters, as specified in the <a href="/realtime/history">history</a> API documentation.</dd>
	<dt><div lang="nodejs,javascript">callback</div></dt>
	<dd>is a function of the form: <code>callback(err, messages, relParams)</code><br />
where:<br />
<ul><br />
<li><code>err</code> contains an error value on the case of an error response as defined in the <a href="/rest-api#common">REST API</a> documentation</li><br />
<li>on success, <code>messages</code> contains the query result as an array of PresenceMessage objects.</li><br />
<li>where applicable, <code>relParams</code> is a map containing query params for each of the pagination links in the query response (see below).</li><br />
</ul></dd>
</dl>
<p>Further details of the supported query params are in the <a href="/realtime/history">history API</a> documentation.</p>
<div lang="java">
<h4>Returns</h4>
<p>On success, the returned <a href="#paginated-result">PaginatedResult</a> encapsulates a collection of <code>PresenceMessage</code> objects corresponding to the current page of results, and also provides query parameters for any applicable related (eg <code>first</code> or <code>next</code> result pages).</p>
<p>Failure to retrieve the history will raise an <code>AblyException</code>.</p>
<p></div><div lang="ruby"><br />
h4. Returns</p>
<p>On success, <code>json_result</code> contains an array of results whose type corresponds to the result type for the request granularity as specified in <a href="/rest-api/#message-history">REST API</a>.</p>
<p>Example <code>json_result</code>:</p>
<pre lang="json"><code lang="json">[{
  "name": "&lt;event name&gt;",
  "channel": "&lt;channel id&gt;",
  "data": "&lt;message payload&gt;",
  "timestamp": "&lt;message timestamp&gt;"
}]</code></pre>
<p>Failure to retrieve the history will raise an exception &#8211; typical exceptions include:</p>
<ul>
	<li><code>Ably::NetworkUnavailableException</code></li>
	<li><code>Ably::QuotaExceededException</code></li>
	<li><code>Ably::AuthenticationFailureException</code></li>
</ul>
<p></div><div lang="nodejs,javascript"></p>
<h4>Pagination</h4>
<p>A paginated result is indicated in the <code>relParams</code> callback argument. For each available link, <code>relParams</code> contains a map of params to pass to a subsequent <code>history()</code> call.<br />
  Example <code>relParams</code>:</p>
<pre lang="json"><code lang="json">[{
  "first": {"start": 1380794880000, "end": 138079488105, ...},
  "current": {"start": 1380794880000, "end": 138079488105, ...},
  "next": {"start": 1380794880000, "end": 138079488105, ...}
}]</code></pre>
<p>Further details of the paginated response are in the <a href="/realtime/history">history API</a> documentation.</p>
</div>
<h2 id="presence-message">PresenceMessage</h2>
<p>A <code>PresenceMessage</code> encapsulates an individual presence update sent or received in Ably. A presence message has the following members.</p>
<dl>
	<dt><span lang="java">String</span>clientId</dt>
	<dd>The id of the client associated with the update. This <span lang="default">property</span><span lang="java">field</span> is populated by the system, where the clientId is known, for messages delivered to subscribers. It is not required to populate the clientId of a message before publishing it.</dd>
</dl>
<dl>
	<dt><span lang="java">String</span>memberId</dt>
	<dd>A unique id for the client associated with the update, to disambiguate in the case that a single clientId is simultaneously present multiple times (eg on different connections). This <span lang="default">property</span><span lang="java">field</span> is populated by the system, where the memberId is known, for messages delivered to subscribers.</dd>
</dl>
<dl>
	<dt><span lang="java">Object</span>clientData</dt>
	<dd>An optional message payload for a status line or other data associated with the presence update. The data may be one of the supported payload datatypes.</dd>
</dl>
<h2 id="presence-listener">PresenceListener</h2>
<div lang="javascript,nodejs">
<p>A <code>PresenceListener</code> function may be subscribed for all presence messages received on the channel. The message is passed as the first argument to the listener.</p>
<p></div><div lang="java"><br />
A implementation of the <code>PresenceListener</code> interface may be registered to be notified of  arrival of presence messages on the channel. A <code>PresenceMessage[]</code> is passed as the first argument of the listener&#8217;s <code>onPresenceMessage</code> method whenever a presence message is received on the channel.</p>
<p></div><div lang="java"><br />
h2(#paginated-result). PaginatedResult</p>
<p>A <code>PaginatedResult</code> is an interface that represents the result of a query that supports pagination. An instance of <code>PaginatedResult</code> encapsulates a collection of <code>PresenceMessage</code> objects representing the current page of results, and provides the means &#8211; in the form of <code>Param[]</code> to perform queries for subsequent or related pages.</p>
<dl>
	<dt>public PresenceMessage[] asArray()</dt>
	<dd>Returns the current page of results as an Array.</dd>
	<dt>public List&lt;PresenceMessage&gt;</dt>
	<dd>Returns the current page of results as a List.</dd>
	<dt>public Param[] getFirst()</dt>
	<dd>Returns the params to pass to a <code>history()</code> call to reproduce the first call in this paginated sequence.</dd>
	<dt>public Param[] getCurrent()</dt>
	<dd>Returns the params to pass to a <code>history()</code> call to reproduce the current call in this paginated sequence.</dd>
	<dt>public Param[] getNext()</dt>
	<dd>Returns the params to pass to a <code>history()</code> call to reproduce the next call in this paginated sequence.</dd>
</dl>
</div>
    </article>
    <hr class="back">
    <a href="#documentation">Back to top</a>
  </div>
  <div id="sidebar">
  <a href="/" title="API Documentation Home"><img src="/assets/ably-logo.png" class="ably-logo" title="API Documentation Home"></a>
  <ul>
<li class=''><a href='/root/quick-start-guide/'>Quickstart Guide</a></li>
<li class=''><a href='/root/how-ably-works/'>How Ably works</a></li>
<li class=''><a href='/root/usage-limits-billing/'>Usage Limits &amp; Billing</a></li>
</ul>
  <h2><a href="/realtime/">Realtime client lib</a></h2>
<ul>
<li class=''><a href='/realtime/usage/'>Using the Realtime library</a></li>
<li class=''><a href='/realtime/connection/'>Connection</a></li>
<li class=''><a href='/realtime/channels-messages/'>Channels and Messages</a></li>
<li class='selected'><a href='/realtime/presence/'>Presence</a></li>
<li class=''><a href='/realtime/authentication/'>Authentication</a></li>
<li class=''><a href='/realtime/history/'>History</a></li>
<li class=''><a href='/realtime/statistics/'>Statistics</a></li>
<li class=''><a href='/realtime/types/'>Types</a></li>
</ul>
  <h2><a href="/rest/">REST client lib</a></h2>
<ul>
<li class=''><a href='/rest/usage/'>Using the REST library</a></li>
<li class=''><a href='/rest/channels-messages/'>Channels and Messages</a></li>
<li class=''><a href='/rest/presence/'>Presence</a></li>
<li class=''><a href='/rest/authentication/'>Authentication</a></li>
<li class=''><a href='/rest/history/'>History</a></li>
<li class=''><a href='/rest/statistics/'>Statistics</a></li>
<li class=''><a href='/rest/encryption/'>Encryption</a></li>
</ul>
  <h2><a href="/rest-api/">REST API</a></h2>
<ul>
</ul>
  <h2>General</h2>
<ul>
<li class=''><a href='/general/authentication/'>Authentication</a></li>
<li class=''><a href='/general/channel-rules-namespaces/'>Channel Rules and Namespaces</a></li>
<li class=''><a href='/general/webhooks/'>Receiving Webhooks</a></li>
<li class=''><a href='/general/statistics/'>Application Statistics</a></li>
<li class=''><a href='/general/migrating/'>Migrating to Ably</a></li>
</ul>
  <h2><a href="/client-lib-development-guide/">Library Development</a></h2>
<ul>
<li class=''><a href='/client-lib-development-guide/features/'>Features spec v0.8</a></li>
<li class=''><a href='/client-lib-development-guide/feature-prioritisation/'>Feature prioritisation</a></li>
<li class=''><a href='/client-lib-development-guide/protocol/'>Realtime Protocol Definition</a></li>
<li class=''><a href='/client-lib-development-guide/rest-api/'>REST API Definition</a></li>
<li class=''><a href='/client-lib-development-guide/test-api/'>Sandbox Test API</a></li>
<li class=''><a href='/client-lib-development-guide/encryption/'>Encryption</a></li>
<li class=''><a href='/client-lib-development-guide/websocket/'>WebSocket Transport</a></li>
<li class=''><a href='/client-lib-development-guide/comet/'>Comet Transport</a></li>
<li class=''><a href='/client-lib-development-guide/connection-recovery/'>Connection Recovery</a></li>
<li class=''><a href='/client-lib-development-guide/connection-manager/'>Connection Manager</a></li>
<li class=''><a href='/client-lib-development-guide/connection-fallback/'>Connection host fallback</a></li>
<li class=''><a href='/client-lib-development-guide/documentation-formatting-guide/'>Documentation Formatting Guide</a></li>
<li class=''><a href='/code-index/'>Code Examples List</a></li>
</ul>
  <ul>
<li><a href="https://www.ably.io">Visit Ably.io</a></li>
</ul>
</div>

</body>
</html>
